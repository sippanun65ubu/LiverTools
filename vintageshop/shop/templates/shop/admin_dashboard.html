<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>

    <!-- Bootstrap & jQuery -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Select2 (for Category selection) -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <style>
        body {
            background-color: #f8f9fa;
            font-family: Arial, sans-serif;
        }
        .dashboard-container {
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            background: white;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }
        .btn-group a {
            margin-right: 10px;
        }
        .hidden {
            display: none;
        }
        .product-form {
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            background: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <div class="text-center p-3 rounded shadow-sm bg-white" style="max-width: 600px; margin: auto;">
            <h2 class="mb-3">
                <img src="https://cdn-icons-png.flaticon.com/512/3898/3898108.png" width="30">
                <strong>Admin Dashboard</strong>
            </h2>
    
            <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á & ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏î‡∏µ -->
            <div class="d-flex justify-content-center gap-2 flex-wrap">
                <a href="{% url 'admin_order_list' %}" class="btn btn-warning btn-sm px-3">
                    üì¶ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
                </a>
                <a href="{% url 'admin_chat' %}" class="btn btn-primary btn-sm px-3">
                    üí¨ ‡πÅ‡∏ä‡∏ó‡∏Å‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
                </a>
                <a href="{% url 'logout' %}" class="btn btn-danger btn-sm px-3">
                    üö™ Logout
                </a>
                <button id="toggleFormBtn" class="btn btn-success btn-sm px-3">
                    ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                </button>
            </div>
        </div>

        <!-- ‚úÖ ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≠‡∏ô‡πÅ‡∏£‡∏Å) -->
        <div id="productFormContainer" class="hidden mt-3">
            <h2 class="mt-4">üõç ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
            <form method="post" enctype="multipart/form-data" class="product-form">
                {% csrf_token %}
                {{ form.as_p }}
                <button type="submit" class="btn btn-primary">üìå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
            </form>
        </div>

        <script>
            $(document).ready(function() {
                // ‚úÖ ‡∏ã‡πà‡∏≠‡∏ô/‡πÅ‡∏™‡∏î‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°
                $("#toggleFormBtn").click(function() {
                    $("#productFormContainer").toggleClass("hidden");
                });

                // ‚úÖ ‡πÉ‡∏ä‡πâ Select2 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                $('#id_category').select2({
                    placeholder: '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤',
                    allowClear: true
                });
            });
        </script>

<div class="container mt-4">
    <h2 class="mb-3">üìã ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>

    <!-- ‚úÖ ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
    <input type="text" id="searchBox" class="form-control mb-3" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤...">

    <!-- ‚úÖ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
    <p id="noResults" class="text-danger text-center" style="display: none;">‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>

    <!-- ‚úÖ ‡πÉ‡∏ä‡πâ Bootstrap Grid System ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
    <div class="row" id="productGrid">
        {% for product in products %}
        <div class="col-md-4 mb-4 product-item">
            <div class="card h-100 shadow-sm">
                <!-- ‚úÖ ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
                {% if product.image %}
                    <img src="{{ product.image.url }}" class="card-img-top img-fluid" style="max-height: 200px; object-fit: cover;">
                {% else %}
                    <img src="https://via.placeholder.com/200" class="card-img-top img-fluid">
                {% endif %}

                <div class="card-body">
                    <h5 class="card-title text-primary">{{ product.name }}</h5>
                    <p class="card-text">
                        üí∞ <strong>{{ product.price }} ‡∏ö‡∏≤‡∏ó</strong> | üìè ‡∏Ç‡∏ô‡∏≤‡∏î: {{ product.size }}
                    </p>

                    <p class="card-text">
                        üìÇ ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà: 
                        {% if product.category.all %}
                            {% for cat in product.category.all %}
                                {{ cat.name }}{% if not forloop.last %}, {% endif %}
                            {% endfor %}
                        {% else %}
                            (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà)
                        {% endif %}
                    </p>

                    <!-- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ -->
                    <p>
                        üì¶ ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: 
                        {% if product.quantity > 5 %}
                            <span class="text-success">{{ product.quantity }} ‡∏ä‡∏¥‡πâ‡∏ô</span>
                        {% elif product.quantity > 0 %}
                            <span class="text-warning">‡πÄ‡∏´‡∏•‡∏∑‡∏≠ {{ product.quantity }} ‡∏ä‡∏¥‡πâ‡∏ô (‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î!)</span>
                        {% else %}
                            <span class="text-danger">‚ùå ‡∏´‡∏°‡∏î‡∏™‡∏ï‡πá‡∏≠‡∏Å</span>
                        {% endif %}
                    </p>
                </div>

                <div class="card-footer text-center">
                    <a href="{% url 'edit_product' product.id %}" class="btn btn-sm btn-info">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</a>
                    <a href="{% url 'delete_product' product.id %}" class="btn btn-sm btn-danger" onclick="return confirm('‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?');">üóë ‡∏•‡∏ö</a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>


    <!-- ‚úÖ ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ö‡∏ö real-time -->
    <script>
        $(document).ready(function() {
            $("#searchBox").on("keyup", function() {
                var searchText = $(this).val().toLowerCase().trim();
                var hasResults = false;

                $(".product-item").each(function() {
                    var itemName = $(this).find(".product-name").text().toLowerCase().trim();
                    if (itemName.includes(searchText)) {
                        $(this).show();
                        hasResults = true;
                    } else {
                        $(this).hide();
                    }
                });

                // ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
                if (hasResults) {
                    $("#noResults").hide();
                } else {
                    $("#noResults").show();
                }
            });
        });
    </script>
</body>
</html>
