{% load cart_extras %}
<div class="container mt-5">

    <!-- ‚úÖ Header + ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏ñ‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô, ‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢, ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤) -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="order-2 mb-0">üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h1>
        <a href="{% url 'product_list' %}" class="btn-shop-more order-1">üõç ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</a>
    </div>

    {% if orders %}
        <div class="table-responsive">
            <table class="table table-bordered table-striped align-middle text-center">
                <thead class="table-dark">
                    <tr>
                        <th>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</th>
                        <th>üìç ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</th>
                        <th>üõí ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                        <th>üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°</th>
                        <th>üí≥ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                        <th>üìú ‡∏™‡∏•‡∏¥‡∏õ</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in orders %}
                    <tr>
                        <td>{{ order.created_at|date:"d M Y, H:i" }}</td>
                        <td>
                            {% if order.address_line %}
                                {{ order.address_line }} ({{ order.zip_code }})
                            {% else %}
                                <span class="text-muted">- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -</span>
                            {% endif %}
                        </td>
                        <td>
                            <ul class="list-unstyled mb-0">
                                {% for item in order.items.all %}
                                    <li>üì¶ {{ item.product.name }} ({{ item.quantity }} ‡∏ä‡∏¥‡πâ‡∏ô) - {{ item.price }} ‡∏ö‡∏≤‡∏ó</li>
                                {% endfor %}
                            </ul>
                        </td>
                        <td>
                            <strong class="text-success">
                                {{ order.total_price|default:"‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö" }} ‡∏ö‡∏≤‡∏ó
                            </strong>
                        </td>
                        <td>
                            {% if order.status == "waiting_confirm" %}
                                <span class="badge bg-warning">‚è≥ ‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</span>
                            {% elif order.status == "approved" %}
                                <span class="badge bg-success">‚úÖ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</span>
                            {% elif order.status == "rejected" %}
                                <span class="badge bg-danger">‚ùå ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò</span>
                            {% elif order.status == "completed" %}
                                <span class="badge bg-primary">üéâ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if order.payment_slip %}
                                <a href="{{ order.payment_slip.url }}" target="_blank">
                                    <img src="{{ order.payment_slip.url }}" class="img-thumbnail" style="max-width: 80px;">
                                </a>
                            {% else %}
                                <span class="text-danger">‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏•‡∏¥‡∏õ</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <p class="text-center text-muted">‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>
    {% endif %}
</div>

<!-- üîù ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô -->
<button onclick="scrollToTop()" id="backToTopBtn" title="‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô">üîù ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô</button>

<!-- ‚úÖ JavaScript -->
<script>
    window.onscroll = function() { scrollFunction(); };

    function scrollFunction() {
        var btn = document.getElementById("backToTopBtn");
        if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
            btn.style.display = "block";
        } else {
            btn.style.display = "none";
        }
    }

    function scrollToTop() {
        window.scrollTo({top: 0, behavior: 'smooth'});
    }
</script>

<!-- ‚úÖ CSS -->
<style>
    .table th, .table td {
        vertical-align: middle;
        border: 1px solid #dee2e6;
        padding: 10px;
    }
    .table th {
        background-color: #343a40;
        color: white;
    }
    .badge {
        font-size: 1rem;
        padding: 8px 12px;
    }

/* üé® ‡∏õ‡∏∏‡πà‡∏° "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡πà‡∏≠" */
.btn-shop-more {
    padding: 10px 18px;
    font-size: 16px;
    font-weight: bold;
    color: white;
    background: linear-gradient(to right, #ff7e5f, #ff3e8e);
    border: none;
    border-radius: 25px;
    transition: all 0.3s ease-in-out;
    text-decoration: none;
    box-shadow: 0px 4px 10px rgba(255, 62, 142, 0.3);
}

.btn-shop-more:hover {
    background: linear-gradient(to right, #ff3e8e, #ff7e5f);
    transform: scale(1.05);
    box-shadow: 0px 6px 15px rgba(255, 62, 142, 0.4);
}

/* üîù ‡∏õ‡∏∏‡πà‡∏° Back to Top */
#backToTopBtn {
    display: none;
    position: fixed;
    bottom: 20px;
    right: 20px;
    background-color: #007bff;
    color: white;
    border: none;
    padding: 10px 15px;
    border-radius: 50px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s;
    box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
}

#backToTopBtn:hover {
    background-color: #0056b3;
}

</style>
